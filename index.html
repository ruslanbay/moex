<!DOCTYPE html>
<html lang="en">

<head>
  <title>MOEX Visualization</title>
  <base href="https://ruslanbay.github.io/moex/">
  <meta charset="UTF-8">
  <meta name="description" content="Russian Stock Market Visualization. How the Russian stock market has changed over the past 20+ years">
  <meta name="theme-color" content="#414554" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="MOEX Visualization">

  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="icon" href="images/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="images/icons/icon-152x152.png">
  
  <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/plotly.js/dist/plotly.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3/dist/d3.min.js"></script>
  
  <!-- <script src="scripts/install.js"></script> -->
  <script src="scripts/main.js"></script>
  <script type="text/javascript">
    // Prevent the default context menu from appearing on right-click
    document.addEventListener("contextmenu", event => event.preventDefault());
  </script>
</head>

<body>
  <header>
    <input type="date" id="dateInput" name="date" pattern="\d{4}-\d{2}-\d{2}" value="2023-12-08" min="2011-12-19" max="2024-03-04">
    &nbsp;&nbsp;
    <a href="" title="MOEX Treemap">
      <img class="header-icon" src="images/icons/treemap.jpeg"/>
    </a>
    <a href="history" title="MOEX Histogram">
      <img class="header-icon" src="images/icons/scatter.jpeg"/>
    </a>
    <a href="listings" title="MOEX Listings">
      <img class="header-icon" src="images/icons/bar.jpeg"/>
    </a>
    &nbsp;&nbsp;&nbsp;
  </header>
  <div id="chart"></div>
  <footer>
    <a href="https://github.com/ruslanbay" title="GitHub">
      <img src="images/icons/github.svg" height="10" /> GitHub
    </a>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <a href="https://www.linkedin.com/in/ruslanbay" title="Linkedin">
      <img src="images/icons/linkedin.svg" height="10" /> Linkedin
    </a>
  </footer>
  <script type="text/javascript">
    const input = document.querySelector("#dateInput");
    input.addEventListener("change", refreshChart);
    
    var currentDate = new Date();
    while (currentDate.getDay() === 0 || currentDate.getDay() === 6) {
      currentDate.setDate(currentDate.getDate() - 1);
    }
    var formattedDate = currentDate.toISOString().split('T')[0];
    document.querySelector("#dateInput").value = formattedDate;
    document.querySelector("#dateInput").max = formattedDate;

    refreshChart({
      target: {
        value: formattedDate
      }
    });

    // PWA: Register service-worker.js
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("scripts/service-worker.js")
      });
    }
  </script>
</body>

</html>
